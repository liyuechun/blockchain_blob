---
layout: post
title: "ã€0003ã€ -  Solidityåˆçº¦ç»“æ„ï¼ˆçŠ¶æ€å˜é‡ã€å±€éƒ¨å˜é‡ã€æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€ç”Ÿå‘½å‘¨æœŸï¼‰"
date: 2017-09-28
description: "æœ¬æ–‡å°†å¯¹ä¸€ä¸ªå®Œæ•´çš„Counteråˆçº¦è¿›è¡Œå‰–æï¼Œä¸€æ­¥æ­¥å‘Šè¯‰ä½ ï¼Œä»€ä¹ˆæ˜¯åˆçº¦ï¼Œåˆçº¦å®Œæ•´çš„ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Œä»¥åŠä¸€ä¸ªåˆçº¦ä¸­çš„çŠ¶æ€å˜é‡ã€å±€éƒ¨å˜é‡ã€æ„é€ å‡½æ•°ã€ææ„å‡½æ•°"
tag: Solidityç³»åˆ—
keywords: "Solidity lifecycle,solidity contract lifecycleï¼Œcontract ç”Ÿå‘½å‘¨æœŸï¼Œcontract æ„é€ å‡½æ•° ææ„å‡½æ•°"
---

>æ¥æºï¼š [é»è·ƒæ˜¥åŒºå—é“¾åšå®¢](http://liyuechun.org)

## ä»€ä¹ˆæ˜¯åˆçº¦ï¼Ÿ

åœ¨åŒºå—é“¾ä¸Šè¿è¡Œçš„ç¨‹åºï¼Œé€šå¸¸ç§°ä¸º`æ™ºèƒ½åˆçº¦ï¼ˆSmart Contractï¼‰ğŸ“’`ã€‚æ‰€ä»¥é€šå¸¸ä¼šæŠŠå†™`åŒºå—é“¾ç¨‹åº`æ”¹ç§°`å†™æ™ºèƒ½åˆçº¦`ã€‚

ç®€å•ç‚¹æ¥è®²ï¼Œåˆçº¦å°±æ˜¯è¿è¡Œåœ¨åŒºå—é“¾ä¸Šçš„ä¸€æ®µç¨‹åºã€‚

## ä¸€ä¸ªå®Œæ•´çš„åˆçº¦

```
pragma solidity ^0.4.4;

contract Counter {
 
    uint count = 0;
    address owner;

    function Counter() {
       owner = msg.sender;
    } 

    function increment() public {
       uint step = 10;
       if (owner == msg.sender) {
          count = count + step;
       }
    }
 
    function getCount() constant returns (uint) {
       return count;
    }

    function kill() {
       if (owner == msg.sender) { 
          selfdestruct(owner);
       }
    }
}
```


### ç‰ˆæœ¬å£°æ˜

```
pragma solidity ^0.4.4;
```

`pragma solidity`ä»£è¡¨`solidity`ç‰ˆæœ¬å£°æ˜ï¼Œ`0.4.4`ä»£è¡¨`solidity`ç‰ˆæœ¬ï¼Œ`^`è¡¨ç¤ºå‘ä¸Šå…¼å®¹ï¼Œ`^0.4.4`è¡¨ç¤º`solidity`çš„ç‰ˆæœ¬åœ¨`0.4.4 ~ 0.5.0(ä¸åŒ…å«0.5.0)`çš„ç‰ˆæœ¬éƒ½å¯ä»¥å¯¹ä¸Šé¢çš„åˆçº¦ä»£ç è¿›è¡Œç¼–è¯‘ï¼Œ`0.4.5`,`0.4.8`ç­‰ç­‰å¯ä»¥ç”¨æ¥ä¿®å¤å‰é¢çš„`solidity`å­˜åœ¨çš„ä¸€äº›`bug`ã€‚

### åˆçº¦å£°æ˜

`contract`æ˜¯åˆçº¦å£°æ˜çš„å…³é”®å­—ï¼Œ`Counter`æ˜¯åˆçº¦åå­—ï¼Œ`contract Counter`å°±æ˜¯å£°æ˜ä¸€ä¸ª`Counter`åˆçº¦ã€‚

`contract`ç›¸å½“äºå…¶ä»–è¯­è¨€ä¸­çš„`class`ï¼Œ`Counter`ç›¸å½“äºç±»åï¼Œ`contract Counter`ç›¸å½“äº`class Counter extends Contract`ã€‚


### çŠ¶æ€å˜é‡

```
uint count = 0;
address owner;
```

`count`å’Œ`owner`å°±æ˜¯çŠ¶æ€å˜é‡ï¼Œåˆçº¦ä¸­çš„çŠ¶æ€å˜é‡ç›¸å½“äº`ç±»`ä¸­çš„å±æ€§å˜é‡ã€‚

### æ„é€ å‡½æ•°ï¼ˆContructorï¼‰

`function Counter()`å‡½æ•°åå’Œåˆçº¦åç›¸åŒæ—¶ï¼Œæ­¤å‡½æ•°æ˜¯åˆçº¦çš„æ„é€ å‡½æ•°ï¼Œå½“åˆçº¦å¯¹è±¡åˆ›å»ºæ—¶ï¼Œä¼šå…ˆè°ƒç”¨æ„é€ å‡½æ•°å¯¹ç›¸å…³æ•°æ®è¿›è¡Œåˆå§‹åŒ–å¤„ç†ã€‚


### æˆå‘˜å‡½æ•°

`function increment() public`å’Œ`function getCount() constant returns (uint)`éƒ½æ˜¯`Counter`åˆçº¦çš„æˆå‘˜å‡½æ•°ï¼Œæˆå‘˜å‡½æ•°åœ¨iOSé‡Œé¢å«åšæ–¹æ³•ã€è¡Œä¸ºï¼Œåˆçº¦å®ä¾‹å¯ä»¥è°ƒç”¨æˆå‘˜å‡½æ•°å¤„ç†ç›¸å…³æ“ä½œã€‚å½“è°ƒç”¨`increment()`å‡½æ•°æ—¶ï¼Œä¼šè®©`çŠ¶æ€å˜é‡count`å¢åŠ `step`ã€‚å½“è°ƒç”¨`getCount()`æ—¶ä¼šå¾—åˆ°çŠ¶æ€å˜é‡`count`çš„å€¼ã€‚


### æœ¬åœ°å˜é‡

```
function increment() public {
   uint step = 10;
   if (owner == msg.sender) {
      count = count + step;
   }
}
```
`increment()`æ–¹æ³•ä¸­å£°æ˜çš„`step`å°±æ˜¯å±€éƒ¨å˜é‡ã€‚å±€éƒ¨å˜é‡åªåœ¨ç¦»å®ƒæœ€è¿‘çš„`{}`å†…å®¹ä½¿ç”¨ã€‚

### ææ„å‡½æ•°ï¼ˆselfdestructï¼‰

`ææ„å‡½æ•°`å’Œ`æ„é€ å‡½æ•°`å¯¹åº”ï¼Œæ„é€ å‡½æ•°æ˜¯åˆå§‹åŒ–æ•°æ®ï¼Œè€Œææ„å‡½æ•°æ˜¯é”€æ¯æ•°æ®ã€‚åœ¨`counter`åˆçº¦ä¸­ï¼Œå½“æˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨`kill`å‡½æ•°æ—¶ï¼Œå°±ä¼šè°ƒç”¨`selfdestruct(owner)`é”€æ¯å½“å‰åˆçº¦ã€‚


## æŠ€æœ¯äº¤æµ

- åŒºå—é“¾æŠ€æœ¯äº¤æµQQç¾¤ï¼š348924182

- ã€ŒåŒºå—é“¾éƒ¨è½ã€å®˜æ–¹å…¬ä¼—å·

![](http://om1c35wrq.bkt.clouddn.com/%E5%8C%BA%E5%9D%97%E9%93%BE%E9%83%A8%E8%90%BD.png)

